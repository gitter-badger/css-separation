"use strict";var collectionSize,css,cssSeparation,each,extend,fs,hasStr,isArray,isEmpty,isObjectBrace,isString,isUndefined,trim,util,_default;fs=require("fs"),extend=require("xtend"),util=require("gulp-util"),css=require("css"),hasStr=require("amp-includes"),trim=require("amp-trim"),each=require("amp-each"),collectionSize=require("amp-size"),isString=require("amp-is-string"),isEmpty=require("amp-is-empty"),isArray=require("amp-is-array"),isUndefined=require("amp-is-undefined"),isObjectBrace=require("is-object-brace"),_default={beautify:!1,conditionalClass:[".ie7",".ie8"]},cssSeparation=function(){function e(){var e;e=arguments[0],this.options=isObjectBrace(e)?extend(_default,e):_default}return e.prototype.getSource=function(e){return isString(e)&&!isEmpty(e)?fs.readFileSync(e,{encoding:"utf8"}):void 0},e.prototype.getAST=function(e){return isString(e)&&!isEmpty(e)?css.parse(this.getSource(e)):void 0},e.prototype.getRules=function(e){return this.getAST(e).stylesheet.rules},e.prototype.isConditionalSelector=function(e){var t,i;return i=this,t=void 0,each(i.options.conditionalClass,function(i){hasStr(e,i)&&(t=!0)}),isUndefined(t)?!1:t},e.prototype.getSelectors=function(e,t){var i,r,n;return r=this,i="",n=[],collectionSize(e.selectors)>=2?(each(e.selectors,function(e,o,s){return t?r.isConditionalSelector(e)?n.push(e):void 0:i+=o!==collectionSize(s)-1?r.options.beautify?e+",\n":e+",":e}),t&&(isEmpty(n)||(util.log(n),i+=collectionSize(n)>=2?n.join(r.options.beautify?",\n":","):n[0]))):i+=t?r.isConditionalSelector(e.selectors[0])?e.selectors[0]:"":e.selectors[0],i},e.prototype.getDeclarations=function(e){return e.declarations},e.prototype.getCommonCss=function(e){var t,i;return t=this,i="",each(this.getRules(e),function(e){"rule"===e.type&&(i+=t.getSelectors(e,!0),each(t.getDeclarations(e),function(e,r,n){0===r&&(i+=t.options.beautify?" {\n":"{"),isUndefined(e.property)||(i+=t.options.beautify?"\n	"+e.property+": "+e.value+";\n":e.property+":"+e.value+";"),r===collectionSize(n)-1&&(i+=t.options.beautify?"\n}\n\n":"}")}))}),i},e.prototype._writeFile=function(e,t){fs.writeFileSync(t,this.getCommonCss(e))},e}(),module.exports=cssSeparation;